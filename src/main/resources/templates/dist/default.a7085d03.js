(self["webpackChunk"]=self["webpackChunk"]||[]).push([[913],{96016:function(e){e.exports={egg:"egg___2GCqW"}},64150:function(e){e.exports={"table-toolbar":"table-toolbar___HvhMo"}},9684:function(e,t,r){"use strict";r.d(t,{f:function(){return i},m:function(){return s}});var n=r(97175),a={basename:"/"};window.routerBase&&(a.basename=window.routerBase);var s={NODE_ENV:"production"}.__IS_SERVER?null:(0,n.q_)(a),i=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e||(s=(0,n.q_)(a)),s}},72255:function(e,t,r){"use strict";r.d(t,{B:function(){return a}});var n=r(79004),a=new n.Sy({validKeys:["modifyClientRenderOpts","patchRoutes","rootContainer","render","onRouteChange","__mfsu","dva","getInitialState","initialStateConfig","request"]})},46496:function(e,t,r){"use strict";r.d(t,{ql:function(){return c.q},$j:function(){return i.$j},m8:function(){return a.m},BA:function(){return s.B},I0:function(){return i.I0}});var n,a=r(9684),s=r(72255),i=r(14494);r(94347),r(80481),r(48399),r(53776),r(94043),r(11238),r(69826),r(17818);(function(e){e[e["SILENT"]=0]="SILENT",e[e["WARN_MESSAGE"]=1]="WARN_MESSAGE",e[e["ERROR_MESSAGE"]=2]="ERROR_MESSAGE",e[e["NOTIFICATION"]=4]="NOTIFICATION",e[e["REDIRECT"]=9]="REDIRECT"})(n||(n={}));var c=r(64593)},94347:function(e,t,r){"use strict";r.d(t,{D0:function(){return g}});var n=r(8870),a=r(3182),s=r(94043),i=r.n(s),c=r(67294),u=r(79004),o=r(69502),l=r(12918),d=r(46496),p=r(20765);function f(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}function h(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var i=a?Object.getOwnPropertyDescriptor(e,s):null;i&&(i.get||i.set)?Object.defineProperty(n,s,i):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}var m=null;function v(){return x.apply(this,arguments)}function x(){return x=(0,a.Z)(i().mark((function e(){var t,a,s,c,f=arguments;return i().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:{},a=d.BA.applyPlugins({key:"dva",type:u.Ac.modify,initialValue:{}}),e.next=4,Promise.resolve().then((()=>h(r(80481))));case 4:return s=e.sent.default,e.next=7,Promise.resolve().then((()=>h(r(48399))));case 7:return c=e.sent.default,m=(0,o.ZP)((0,n.Z)((0,n.Z)((0,n.Z)({history:d.m8},a.config||{}),"undefined"!==typeof window&&window.g_useSSR?{initialState:window.g_initialProps}:{}),t||{})),m.use((0,l.Z)()),m.use((0,p.ZP)()),(a.plugins||[]).forEach((e=>{m.use(e)})),m.model((0,n.Z)({namespace:"gamer"},s)),m.model((0,n.Z)({namespace:"model"},c)),e.abrupt("return",m);case 15:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function Z(){return m}function j(){return"undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement}class g extends c.Component{constructor(e){super(e),j()&&v().then((()=>{this.forceUpdate()}))}componentWillUnmount(){var e=Z();e._models.forEach((t=>{e.unmodel(t.namespace)})),e._models=[];try{e=null}catch(t){console.error(t)}}render(){var e=Z();return e?(e.router((()=>this.props.children)),e.start()()):null}}},71310:function(e,t,r){"use strict";r.d(t,{y:function(){return a}});var n=r(67294),a=n.createContext({})},53776:function(e,t,r){"use strict";r.d(t,{t:function(){return u}});var n=r(57337),a=r(67294),s=r(92800),i=r.n(s),c=r(71310);function u(e,t){var r=(0,a.useContext)(c.y),s=(0,a.useRef)(t);s.current=t;var u=(0,a.useState)((()=>s.current?s.current(r.data[e]):r.data[e])),o=(0,n.Z)(u,2),l=o[0],d=o[1],p=(0,a.useRef)(l);p.current=l;var f=(0,a.useRef)(!1);return(0,a.useEffect)((()=>(f.current=!0,()=>{f.current=!1})),[]),(0,a.useEffect)((()=>{var n=n=>{if(f.current)if(t&&s.current){var a=s.current(n),c=p.current;i()(a,c)||d(a)}else d(n);else setTimeout((()=>{r.data[e]=n,r.update(e)}))};try{r.callbacks[e].add(n),r.update(e)}catch(a){r.callbacks[e]=new Set,r.callbacks[e].add(n),r.update(e)}return()=>{r.callbacks[e].delete(n)}}),[e]),l}},40323:function(e,t,r){"use strict";var n={};r.r(n),r.d(n,{rootContainer:function(){return l}});var a={};r.r(a),r.d(a,{rootContainer:function(){return m}});var s={};r.r(s),r.d(s,{rootContainer:function(){return S}});r(82526),r(41817),r(72443),r(92401),r(8722),r(69007),r(83510),r(41840),r(6982),r(32159),r(96649),r(39341),r(92222),r(57327),r(84944),r(86535),r(91038),r(26699),r(82772),r(66992),r(94986),r(21249),r(85827),r(96644),r(65069),r(47042),r(2707),r(38706),r(40561),r(33792),r(99244),r(18264),r(39575),r(96078),r(4855),r(73706),r(51532),r(99752),r(25438),r(10408),r(61874),r(56977),r(19601),r(59595),r(35500),r(69720),r(38559),r(49337),r(94869),r(33952),r(41539),r(26833),r(88674),r(17727),r(36535),r(12419),r(83593),r(24603),r(92087),r(39714),r(70189),r(27852),r(32023),r(4723),r(66528),r(83112),r(15306),r(64765),r(23123),r(23157),r(73210),r(48702),r(55674),r(44197),r(76495),r(87145),r(35109),r(65125),r(82472),r(49743),r(8255),r(29135),r(98145),r(44731),r(95206),r(12974),r(15016),r(4129),r(38478),r(8628),r(83475),r(46273),r(51568),r(26349),r(65743),r(10072),r(99137),r(71957),r(96306),r(103),r(8582),r(90618),r(74592),r(88440),r(58276),r(35082),r(12813),r(18222),r(24838),r(38563),r(50336),r(7512),r(46603),r(70100),r(10490),r(13187),r(60092),r(19041),r(30666),r(51638),r(62975),r(15728),r(46056),r(44299),r(5162),r(50292),r(1025),r(97314),r(96290),r(77479),r(34582),r(47896),r(12647),r(98558),r(84018),r(97507),r(61605),r(49076),r(34999),r(88921),r(96248),r(13599),r(11477),r(64362),r(15389),r(46006),r(90401),r(45164),r(91238),r(54837),r(87485),r(56767),r(69916),r(76651),r(61437),r(35285),r(39865),r(86035),r(67501),r(13728),r(27207),r(21568),r(48824),r(44130),r(78206),r(76478),r(79715),r(43561),r(32049),r(86020),r(56585),r(54747),r(33948),r(84633),r(85844),r(60285),r(83753),r(41637),r(17445);var i=r(72255),c=r(77878),u=r(67294),o=r(94347);function l(e,t){return u.createElement(o.D0,t,e)}var d=r(46496),p=r(79004),f=r(53776);if("function"!==typeof f.t)throw new Error("[plugin-initial-state]: useModel is not a function, @umijs/plugin-model is required.");var h=e=>{var t=e.children,r=(0,u.useRef)(!1),n=d.BA.applyPlugins({key:"initialStateConfig",type:p.Ac.modify,initialValue:{}})||{},a=(0,f.t)("@@initialState")||{},s=a.loading,i=void 0!==s&&s;return(0,u.useEffect)((()=>{i||(r.current=!0)}),[i]),i&&!r.current?n.loading||null:t};function m(e){return u.createElement(h,null,e)}var v=r(57337),x=()=>({loading:!1,refresh:()=>{}});class Z{constructor(){this.callbacks={},this.data={},this.update=e=>{(this.callbacks[e]||[]).forEach((t=>{try{var r=this.data[e];t(r)}catch(n){t(void 0)}}))}}}var j=r(85893),g=e=>{var t=e.hook,r=e.onUpdate,n=e.namespace,a=(0,u.useRef)(r);a.current=r;var s,i=(0,u.useRef)(!1);try{s=t()}catch(c){console.error("plugin-model: Invoking '".concat(n||"unknown","' model failed:"),c)}return(0,u.useMemo)((()=>{a.current(s),i.current=!1}),[]),(0,u.useEffect)((()=>{i.current?a.current(s):i.current=!0})),(0,j.jsx)(j.Fragment,{})},w=r(71310),y={"@@initialState":x},b=new Z,k=g,E=e=>{var t=e.children;return(0,j.jsxs)(w.y.Provider,{value:b,children:[Object.entries(y).map((e=>(0,j.jsx)(k,{namespace:e[0],hook:e[1],onUpdate:t=>{var r=e,n=(0,v.Z)(r,1),a=n[0];b.data[a]=t,b.update(a)}},e[0]))),t]})};function S(e){return u.createElement(E,null,e)}i.B.register({apply:c,path:"/home/culler/code/workspace/larp-front/src/app.tsx"}),i.B.register({apply:n,path:"/home/culler/code/workspace/larp-front/src/.umi-production/plugin-dva/runtime.tsx"}),i.B.register({apply:a,path:"../plugin-initial-state/runtime"}),i.B.register({apply:s,path:"../plugin-model/runtime"});var C=r(9684),_=r(43101);function O(){var e=[{path:"/login",component:r(79484).Z,exact:!0},{path:"/",component:r(46076).Z,redirect:"/login",exact:!0},{path:"/",component:r(94358).Z,routes:[{path:"/gamer",component:r(14606).Z,exact:!0},{path:"/admin",component:r(12531).Z,exact:!0},{path:"/dm",component:r(78251).Z,exact:!0}]}];return i.B.applyPlugins({key:"patchRoutes",type:p.Ac.event,args:{routes:e}}),e}var I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.B.applyPlugins({key:"render",type:p.Ac.compose,initialValue:()=>{var t=i.B.applyPlugins({key:"modifyClientRenderOpts",type:p.Ac.modify,initialValue:{routes:e.routes||O(),plugin:i.B,history:(0,C.f)(e.hot),isServer:{NODE_ENV:"production"}.__IS_SERVER,rootElement:"root",defaultTitle:""}});return(0,_.p)(t)},args:e})},N=I();N();window.g_umi={version:"3.5.13"}},63008:function(e,t,r){"use strict";r.d(t,{G:function(){return c},Sd:function(){return u},xt:function(){return o},u:function(){return l},k$:function(){return d}});var n=r(3182),a=r(94043),s=r.n(a),i=r(72709),c=function(){var e=(0,n.Z)(s().mark((function e(){return s().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.Z)("/game/getCurrentGame",{method:"GET"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,n.Z)(s().mark((function e(t){return s().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.Z)("/roles/list",{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=(0,n.Z)(s().mark((function e(t){return s().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.Z)("/scripts/getScripts",{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=(0,n.Z)(s().mark((function e(t){return s().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.Z)("/clues/getMyClues",{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=(0,n.Z)(s().mark((function e(t){return s().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.Z)("/clues/getLocation",{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},12948:function(e,t,r){"use strict";r(34792);var n=r(48086),a=r(67294),s=r(2825),i=r(96016),c=r.n(i),u=r(85893),o=()=>{var e=(0,a.useRef)(0),t=()=>{if(0===e.current)return n.default.success("\u606d\u559c\u4f60\u89e6\u53d1\u4e86\u4e00\u4e2a\u5c0f\u5f69\u86cb,\u591a\u70b9\u51e0\u6b21\u6709\u60ca\u559c(\u4e0d\u8981\u544a\u8bc9\u5176\u4ed6\u4eba~)"),void(e.current+=1);e.current+=1,10===e.current&&(n.default.success("\u52a0\u6cb9\uff0c\u518d\u70b9\u51e0\u6b21"),e.current=1)};return(0,u.jsx)("div",{className:c().egg,children:(0,u.jsx)(s.Z,{style:{cursor:"pointer",color:"rgb(0, 32, 64)"},onClick:t})})};t["Z"]=o},62708:function(e,t,r){"use strict";r(57663);var n=r(71577),a=(r(67294),r(85893)),s=e=>{var t=e.size,r=e.children;return(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,a.jsx)(n.Z.Group,{size:t,children:r})})};t["Z"]=s},35278:function(e,t,r){"use strict";r(13062);var n=r(71230),a=(r(402),r(56454)),s=(r(67294),r(85893)),i=a.Z.Paragraph,c=e=>{var t=e.description,r=e.gameName;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Z,{children:(0,s.jsx)("h3",{style:{width:"300px",fontSize:22,height:40,borderBottom:"4px solid #000"},children:r})}),(0,s.jsx)(n.Z,{children:(0,s.jsx)(i,{ellipsis:{rows:3,expandable:!0,suffix:"--\u5267\u672c\u4ecb\u7ecd"},title:"\u5267\u672c\u4ecb\u7ecd",children:t})})]})};t["Z"]=c},98580:function(e,t,r){"use strict";r(89032);var n=r(15746),a=(r(13062),r(71230)),s=(r(94233),r(52027)),i=(r(12968),r(92726)),c=(r(402),r(56454)),u=(r(58024),r(39144)),o=(r(67294),r(34436)),l=r(85893),d=(u.Z.Meta,c.Z.Text),p=e=>{var t=e.rolesList;e.size,e.type;return(0,l.jsx)(a.Z,{gutter:8,children:t.map((e=>(0,l.jsxs)(n.Z,{flex:1,children:[(0,l.jsx)(s.C,{shape:"circle",size:60,src:(0,l.jsx)(i.Z,{src:"".concat(o.vU,"/images/1.jpg")})}),(0,l.jsx)(a.Z,{children:(0,l.jsx)(d,{children:"".concat(null===e||void 0===e?void 0:e.roleName,"(").concat(null===e||void 0===e?void 0:e.user,")")})}),(0,l.jsx)(a.Z,{children:(0,l.jsx)(d,{type:"secondary",children:null===e||void 0===e?void 0:e.description})})]},e.id)))})};t["Z"]=p},81547:function(e,t,r){"use strict";r.d(t,{Z:function(){return he}});r(19466);var n=r(10679),a=(r(34792),r(48086)),s=r(3182),i=(r(49111),r(19650)),c=(r(62350),r(75443)),u=(r(57663),r(71577)),o=r(57337),l=r(94043),d=r.n(l),p=r(67294),f=(r(71194),r(57016)),h=(r(66126),r(46127)),m=r(8870),v=(r(84494),r(50537)),x=(r(47673),r(4107)),Z=(r(9715),r(35845)),j=r(19228),g=r(93224),w=r(19619),y=r(16436),b=r(85893),k=v.Z.Dragger,E=e=>{var t=e.fileList,r=e.setFileList,n=(0,g.Z)(e,["fileList","setFileList"]);return(0,b.jsx)(k,(0,m.Z)((0,m.Z)({directory:!0,fileList:t,showUploadList:!1,beforeUpload:(e,t)=>{null===r||void 0===r||r(t)}},n),{},{children:t.length>0?(0,b.jsx)(w.Z,{style:{color:"#447CE6",fontSize:"24px"}}):(0,b.jsx)(y.Z,{style:{color:"#447CE6",fontSize:"24px"}})}))},S=E,C=Z.Z.Item,_=x.Z.TextArea,O={labelCol:{span:6},wrapperCol:{span:18}},I=(v.Z.Dragger,e=>{var t=e.visible,r=e.setVisible,n=e.onUpdate,i=e.gameId,c=Z.Z.useForm(),u=(0,o.Z)(c,1),l=u[0],v=(0,p.useState)([]),g=(0,o.Z)(v,2),w=g[0],y=g[1],k=(0,p.useState)([]),E=(0,o.Z)(k,2),I=E[0],N=E[1],R=(0,p.useState)([]),T=(0,o.Z)(R,2),P=T[0],U=T[1];(0,p.useEffect)((()=>{(0,s.Z)(d().mark((function e(){var r,n;return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}if(!i){e.next=8;break}return e.next=4,(0,j.WY)("/game/detail?gameId=".concat(i));case 4:r=e.sent,200===r.code&&(n=(0,m.Z)({},r.data),l.setFieldsValue(n)),e.next=9;break;case 8:l.resetFields();case 9:case"end":return e.stop()}}),e)})))()}),[t,i]);var A=i?"\u7f16\u8f91":"\u65b0\u5efa",M=()=>{l.resetFields(),r(!1)},L=function(){var e=(0,s.Z)(d().mark((function e(){var t,s,i;return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.validateFields();case 3:return t=e.sent,s=new FormData,t.userNum&&(s.append("minUser",t.userNum[0]),s.append("maxUser",t.userNum[1]),delete t.userNum),Object.entries(t).forEach((e=>{var t=(0,o.Z)(e,2),r=t[0],n=t[1];void 0!==n&&s.append(r,n)})),Object.values(w).forEach((e=>{s.append("scripts",e)})),Object.values(I).forEach((e=>{s.append("clues",e)})),Object.values(P).forEach((e=>{s.append("handbook",e)})),e.next=12,(0,j.WY)("/game/create",{method:"POST",data:s});case 12:i=e.sent,200===i.code?(a.default.success("\u65b0\u5efa\u6210\u529f"),r(!1),l.resetFields(),null===n||void 0===n||n()):a.default.warn(i.msg),e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](0),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return(0,b.jsx)(f.Z,{visible:t,width:500,onCancel:M,onOk:L,title:A,children:(0,b.jsxs)(Z.Z,(0,m.Z)((0,m.Z)({form:l,size:"small"},O),{},{children:[(0,b.jsx)(C,{label:"\u5267\u672c\u6740\u540d\u79f0",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5267\u672c\u6740\u540d\u79f0"}],name:"gameName",children:(0,b.jsx)(x.Z,{placeholder:"\u8bf7\u586b\u5199\u5267\u672c\u6740\u540d\u79f0"})}),(0,b.jsx)(C,{label:"\u4eba\u6570",name:"userNum",children:(0,b.jsx)(h.Z,{range:!0,max:10,min:2})}),(0,b.jsx)(C,{label:"\u6bcf\u8f6e\u6700\u591a\u7ebf\u7d22\u6570",name:"maxClues",rules:[{min:1}],children:(0,b.jsx)(x.Z,{type:"number"})}),(0,b.jsx)(C,{label:"\u603b\u7ae0\u8282",name:"roundTotal",rules:[{min:1}],children:(0,b.jsx)(x.Z,{type:"number"})}),(0,b.jsx)(C,{label:"\u63cf\u8ff0",name:"description",initialValue:"",children:(0,b.jsx)(_,{})}),(0,b.jsx)(C,{label:"\u5bfc\u5165\u5267\u672c",children:(0,b.jsx)(S,{fileList:w,beforeUpload:(e,t)=>{try{if(!l.getFieldValue("gameName")){var r,n=null!==(r=null===e||void 0===e?void 0:e.webkitRelativePath)&&void 0!==r?r:"",a=n.split("/"),s=(0,o.Z)(a,1);n=s[0],l.setFieldsValue({gameName:n})}}catch(i){}y(t)}})}),(0,b.jsx)(C,{label:"\u5bfc\u5165\u7ebf\u7d22",children:(0,b.jsx)(S,{fileList:I,setFileList:N})}),(0,b.jsx)(C,{label:"\u5bfc\u5165\u7ec4\u7ec7\u8005\u624b\u518c",children:(0,b.jsx)(S,{fileList:P,setFileList:U})})]}))})}),N=I,R=(r(17462),r(76772)),T=(r(18106),r(88108)),P=(r(13062),r(71230)),U=(r(89032),r(15746)),A=(r(7359),r(7964)),M=(r(12968),r(92726)),L=(r(58024),r(39144)),F=r(34436),V=L.Z.Meta,G=e=>{var t=e.images,r=e.code,n=e.description,a=e.actions;e.location;return(0,b.jsx)(L.Z,{hoverable:!0,cover:(0,b.jsx)(M.Z,{src:"".concat(F.vU,"/").concat(t)}),actions:a,children:(0,b.jsx)(V,{title:r,description:n})})},W=G,z=A.Z.Panel,B=e=>{var t=e.cluesList,r=((0,p.useMemo)((()=>{var e=new Set;return t.map((t=>{t.round&&e.add(t.round)})),Array.from(e).sort()}),[t]),(0,p.useMemo)((()=>{var e=new Set;return t.map((t=>{t.location&&e.add(t.location)})),Array.from(e)}),[t]),(0,p.useMemo)((()=>{var e=new Map;return t.map((t=>{var r=t.round||-1,n=t.location||"\u5176\u4ed6",a=e.get(r);if(a){var s=a.get(n);s?a.set(n,[...s,t]):a.set(n,[t])}else e.set(r,new Map([[n,[t]]]))})),Array.from(e.entries())}),[t]));return(0,b.jsx)(A.Z,{children:r.map((e=>{var t=(0,o.Z)(e,2),r=t[0],n=t[1];return(0,b.jsx)(z,{header:"\u7b2c".concat(r,"\u8f6e\u7ebf\u7d22"),children:Array.from(n.entries()).map((e=>{var t=(0,o.Z)(e,2),r=t[0],n=t[1];return(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:r}),(0,b.jsx)(P.Z,{gutter:4,children:n.map((e=>(0,b.jsx)(U.Z,{span:6,children:(0,b.jsx)(W,(0,m.Z)({},e))},e.id)))})]},r)}))},r)}))})},q=B,D=r(24616),Y=r(8212),H=r(23094),$=L.Z.Meta,K=e=>{var t=e.avatar,r=e.roleName,n=e.description,a=e.handleClick;return(0,b.jsx)(L.Z,{hoverable:!0,cover:(0,b.jsx)(M.Z,{src:t||(t="".concat(F.vU,"/images/\u5c01\u9762.jpg"))}),actions:[(0,b.jsx)(D.Z,{},"setting"),(0,b.jsx)(Y.Z,{},"edit"),(0,b.jsx)(H.Z,{onClick:()=>{console.log(1),null===a||void 0===a||a()}},"scripts")],children:(0,b.jsx)($,{title:r,description:n})})},J=K,X=r(44545),Q=(L.Z.Meta,e=>{var t=e.content;return(0,b.jsx)(L.Z,{hoverable:!0,cover:(0,b.jsx)(M.Z,{src:"".concat(F.vU,"/").concat(t)}),actions:[(0,b.jsx)(D.Z,{},"setting"),(0,b.jsx)(Y.Z,{},"edit"),(0,b.jsx)(X.Z,{},"ellipsis")]})}),ee=Q,te=e=>{var t=e.visible,r=e.setVisible,n=(e.onUpdate,e.roleId),a=(0,p.useState)([]),i=(0,o.Z)(a,2),c=i[0],u=i[1],l=(0,p.useCallback)((0,s.Z)(d().mark((function e(){var t;return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,j.WY)("/scripts/getAllScripts/".concat(n));case 2:t=e.sent,200===t.code&&u(t.data);case 4:case"end":return e.stop()}}),e)}))),[n]);(0,p.useEffect)((()=>{t&&n&&l()}),[t,n]);var h=()=>{r(!1)},v=()=>{},x="\u89d2\u8272\u5267\u672c";return(0,b.jsx)(f.Z,{width:1e3,visible:t,onCancel:h,onOk:v,title:x,maskClosable:!1,children:(0,b.jsx)(P.Z,{gutter:4,children:(0,b.jsx)(M.Z.PreviewGroup,{children:c.map(((e,t)=>(0,b.jsx)(U.Z,{span:6,children:(0,b.jsx)(ee,(0,m.Z)({},e))},t)))})})})},re=te,ne=e=>{var t=e.rolesList,r=(e.gameId,(0,p.useState)(!1)),n=(0,o.Z)(r,2),a=n[0],s=n[1],i=(0,p.useState)(0),c=(0,o.Z)(i,2),u=c[0],l=c[1];return(0,b.jsxs)("div",{children:[(0,b.jsx)(M.Z.PreviewGroup,{children:(0,b.jsx)(P.Z,{gutter:4,children:t.map(((e,t)=>(0,b.jsx)(U.Z,{span:6,children:(0,b.jsx)(J,(0,m.Z)((0,m.Z)({},e),{},{handleClick:()=>{l(e.id),s(!0)}}))},t)))})}),(0,b.jsx)(re,{visible:a,setVisible:s,roleId:u})]})},ae=ne,se=T.Z.TabPane,ie=e=>{var t=e.visible,r=e.setVisible,n=(e.onUpdate,e.gameId),i="\u5267\u672c\u4e0e\u7ebf\u7d22",c=()=>{r(!1)},l=(0,p.useState)([]),h=(0,o.Z)(l,2),m=h[0],v=h[1],x=(0,p.useState)([]),Z=(0,o.Z)(x,2),g=Z[0],w=Z[1],y=(0,p.useCallback)((0,s.Z)(d().mark((function e(){var t,r,a,s,i,c,u;return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,j.WY)("/game/detail/".concat(n),{method:"POST"});case 2:t=e.sent,200===t.code&&(r=t.data||{},a=r.clues,s=void 0===a?[]:a,i=r.game,void 0===i?{}:i,c=r.roles,u=void 0===c?[]:c,v(u),w(s));case 4:case"end":return e.stop()}}),e)}))),[n]);(0,p.useEffect)((()=>{t&&n&&y()}),[t,n]);var k=()=>{},E=function(){var e=(0,s.Z)(d().mark((function e(){var t;return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,j.WY)("/game/initGame/".concat(n),{method:"POST"});case 2:t=e.sent,200===t.code?(a.default.success("\u521d\u59cb\u5316\u6210\u529f"),y()):a.default.warn(t.msg);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,b.jsxs)(f.Z,{width:1e3,visible:t,onCancel:c,onOk:k,title:i,maskClosable:!1,children:[0===m.length&&(0,b.jsxs)("div",{children:[(0,b.jsx)(R.Z,{message:"\u5f53\u524d\u6ca1\u6709\u89d2\u8272,\u4f60\u53ef\u4ee5\u4ece\u5bfc\u5165\u4e2d\u521d\u59cb\u5316\u751f\u6210",type:"warning"}),(0,b.jsx)(u.Z,{onClick:E,children:"\u521d\u59cb\u5316\u89d2\u8272\u548c\u7ebf\u7d22"})]}),(0,b.jsxs)(T.Z,{defaultActiveKey:"1",onChange:()=>{},children:[(0,b.jsx)(se,{tab:"\u89d2\u8272&\u5267\u672c",children:(0,b.jsx)(ae,{rolesList:m,gameId:n})},"1"),(0,b.jsx)(se,{tab:"\u7ebf\u7d22",children:(0,b.jsx)(q,{gameId:n,cluesList:g})},"2")]})]})},ce=ie,ue=r(19611),oe=r(46496),le=r(76570),de=r(64150),pe=r.n(de),fe=()=>{var e=(0,p.useState)([]),t=(0,o.Z)(e,2),r=t[0],l=t[1],f=(0,p.useState)(!1),h=(0,o.Z)(f,2),m=h[0],v=h[1],x=(0,p.useState)(!1),Z=(0,o.Z)(x,2),g=Z[0],w=Z[1],y=(0,p.useState)(0),k=(0,o.Z)(y,2),E=k[0],S=k[1],C=[{title:"id",dataIndex:"id",key:"id",width:100},{title:"\u6e38\u620f\u540d\u79f0",dataIndex:"gameName",key:"gameName"},{title:"\u4eba\u6570",dataIndex:"userNum",key:"userNum",render:(e,t)=>t.maxUser&&t.minUser?"".concat(t.minUser,"~").concat(t.maxUser,"\u4eba"):null},{title:"\u4e3b\u6301\u4eba",dataIndex:"dm",key:"dm",width:100},{title:"\u5f53\u524d\u72b6\u6001",dataIndex:"status",key:"status",render:(e,t)=>{switch(t.status){case 0:return"\u672a\u5f00\u59cb";case 1:return"\u5f53\u524d";case-1:return"\u5df2\u5b8c\u6210";default:return""}}},{title:"\u64cd\u4f5c",dataIndex:"handle",key:"handle",width:300,render:(e,t)=>(0,b.jsxs)(i.Z,{children:[0===t.status&&(0,b.jsx)(c.Z,{title:"\u786e\u5b9a\u8981\u5220\u9664\u5417",onConfirm:()=>O(t.id),children:(0,b.jsx)(u.Z,{size:"small",danger:!0,children:"\u5220\u9664"},"delete")}),0===t.status&&0===t.round&&(0,b.jsx)(c.Z,{title:"\u786e\u5b9a\u8981\u5f00\u542f\u5417",disabled:0!==t.status,onConfirm:()=>I(t.id),children:(0,b.jsx)(u.Z,{size:"small",type:"primary",children:"\u5f00\u542f\u6e38\u620f"},"start")}),(0,b.jsx)(u.Z,{size:"small",type:"primary",onClick:()=>{S(t.id),w(!0)},children:-1===t.round?"\u521d\u59cb\u5316":"\u67e5\u770b"},"custom"),1===t.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.Z,{title:"\u786e\u5b9a\u8981\u5b8c\u6210\u5417",onConfirm:()=>R(t.id),children:(0,b.jsx)(u.Z,{size:"small",children:"\u5b8c\u6210\u6e38\u620f"},"finish")}),(0,b.jsx)(u.Z,{type:"link",size:"small",children:(0,b.jsx)(ue.rU,{to:"/dm",children:"\u8fdb\u5165\u6e38\u620f"})})]})]})}],_=function(){var e=(0,s.Z)(d().mark((function e(){var t,r;return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,j.WY)("/game/list",{method:"GET"});case 2:r=e.sent,l(null!==(t=r.data)&&void 0!==t?t:[]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=(0,s.Z)(d().mark((function e(t){return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,j.WY)("/game/delete/".concat(t),{method:"POST"});case 2:a.default.success("\u5220\u9664\u6210\u529f"),_();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=(0,s.Z)(d().mark((function e(t){return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,j.WY)("/game/start/".concat(t),{method:"POST"});case 2:return a.default.success("\u5f00\u542f\u6210\u529f"),e.next=5,_();case 5:return e.next=7,(0,j.iG)("\u6e38\u620f\u5df2\u5f00\u542f\uff0c\u662f\u5426\u524d\u5f80");case 7:oe.m8.push("/dm");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=(0,s.Z)(d().mark((function e(t){return d().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,j.WY)("/game/finish/".concat(t),{method:"POST"});case 2:a.default.success("\u5b8c\u6210\u6210\u529f"),_();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,p.useEffect)((()=>{_()}),[]),(0,b.jsxs)("div",{style:{padding:"10px"},children:[(0,b.jsx)("div",{className:pe()["table-toolbar"],children:(0,b.jsx)("div",{children:(0,b.jsx)(i.Z,{children:(0,b.jsx)(u.Z,{icon:(0,b.jsx)(le.Z,{}),type:"primary",onClick:()=>{v(!0)},children:"\u65b0\u5efa\u5267\u672c"})})})}),(0,b.jsx)(n.Z,{rowKey:"id",columns:C,dataSource:r}),(0,b.jsx)(N,{visible:m,setVisible:v,onUpdate:()=>{_()}}),(0,b.jsx)(ce,{visible:g,setVisible:w,gameId:E,onUpdate:()=>{_()}})]})},he=fe},34436:function(e,t,r){"use strict";var n,a;r.d(t,{sP:function(){return a},vU:function(){return s},Lf:function(){return i}}),n||(n={}),function(e){e["SHARE_CLUE"]="share_clue",e["OPEN_CLUE"]="open_clue",e["START_VOTE"]="start_vote",e["SET_NEXT_ROUND"]="set_next_round",e["VOTE"]="vote"}(a||(a={}));var s="/larp",i="ws://".concat(window.location.host.replace("http://",""),"/larp")},94358:function(e,t,r){"use strict";r.d(t,{Z:function(){return P}});var n=r(3182),a=(r(24793),r(97183)),s=r(94043),i=r.n(s),c=r(67294),u=r(46496),o=r(69483),l=r.n(o),d=(r(49111),r(19650)),p=(r(59250),r(16114)),f=r(57337),h=(r(30887),r(99210)),m=r(96534),v=r(8870),x=r(45976),Z=r(85893),j=(0,x.Z)({scriptUrl:"//at.alicdn.com/t/font_2733389_fdfq7bijp2r.js"}),g=e=>(0,Z.jsx)(j,(0,v.Z)((0,v.Z)({},e),{},{type:"icon-maoxian"})),w=r(19228),y=e=>{var t=e.gamer;return{user:t.user}},b=e=>{var t=e.user,r=void 0===t?"":t,a=function(){var e=(0,n.Z)(i().mark((function e(t){var r;return i().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.key,"logout"!==r){e.next=7;break}return e.next=4,(0,m.i)("\u786e\u5b9a\u8981\u9000\u51fa\u5417?");case 4:return e.next=6,l().clear();case 6:u.m8.push("/login");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=(0,Z.jsx)(h.Z,{onClick:a,children:(0,Z.jsx)(h.Z.Item,{children:"\u9000\u51fa"},"logout")}),o=(0,c.useState)(""),v=(0,f.Z)(o,2),x=v[0],j=v[1];return(0,c.useEffect)((()=>{(0,n.Z)(i().mark((function e(){var t,r;return i().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,w.WY)("/users/getList");case 2:t=e.sent,r=t.data.find((e=>{var t=e.role;return 1===t})),r&&j(r.name);case 5:case"end":return e.stop()}}),e)})))()}),[]),(0,Z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",color:"#fff",fontSize:"1.5em"},children:[(0,Z.jsx)(g,{style:{fontSize:"30px"}}),(0,Z.jsxs)("div",{children:["\u672c\u671f\u4e3b\u6301\u4eba : ",x]}),(0,Z.jsx)(d.Z,{size:"large",children:(0,Z.jsx)(p.Z,{overlay:s,children:(0,Z.jsx)("div",{children:r})})})]})},k=(0,u.$j)(y)(b),E=r(19630),S=r(83832),C=r(28085),_=e=>{var t=(0,E.TH)(),r=(0,c.useMemo)((()=>{switch(t.pathname){case"/dm":return(0,Z.jsx)(S.Z,{});case"/gamer":return(0,Z.jsx)(C.Z,{});default:return null}}),[t.pathname]);return r},O=_,I=a.Z.Header,N=a.Z.Footer,R=(a.Z.Sider,a.Z.Content),T=e=>{var t=e.children;return(0,c.useEffect)((()=>{(0,n.Z)(i().mark((function e(){var t;return i().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l().getItem("user");case 2:t=e.sent,t||u.m8.push("/login");case 4:case"end":return e.stop()}}),e)})))()}),[]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(u.ql,{children:(0,Z.jsx)("title",{children:"\u5267\u672c\u6740"})}),(0,Z.jsxs)(a.Z,{style:{height:"100%"},children:[(0,Z.jsx)(I,{style:{height:"50px",lineHeight:"50px"},children:(0,Z.jsx)(k,{})}),(0,Z.jsx)(R,{style:{padding:"0 8px",height:"calc(100% - 100px)",overflow:"hidden"},children:t}),(0,Z.jsx)(N,{style:{background:"rgb(0, 21, 41)",padding:"9px"},children:(0,Z.jsx)(O,{})})]})]})},P=T},96534:function(e,t,r){"use strict";r.d(t,{i:function(){return a},$:function(){return i}});r(71194);var n=r(57016),a=e=>new Promise(((t,r)=>{n.Z.confirm({title:e,onOk(){t(null)},onCancel(){r()}})})),s=e=>Math.floor(Math.random()*e.length+1)-1,i=(e,t)=>{for(var r=Array.from(e),n=[],a=0;a<t;a++)if(r.length>0){var i=s(r);n.push(r[i]),r.splice(i,1)}return n}},59749:function(e,t,r){"use strict";r.d(t,{q:function(){return n},x:function(){return a}});var n=e=>{var t=JSON.parse(e);return t},a=e=>JSON.stringify(e)},19228:function(e,t,r){"use strict";r.d(t,{WY:function(){return n.Z},qz:function(){return a.q},iG:function(){return s.i}});var n=r(72709),a=r(59749),s=r(96534)},72709:function(e,t,r){"use strict";var n=r(3182),a=(r(74379),r(38648)),s=r(94043),i=r.n(s),c=r(11238),u=r(34436);console.log("production");var o=e=>{e.response;var t=e.message,r=e.data;if(console.log(e),"CustomError"===t){var n=r.res,s=n.msg;a.default.error({message:"\u63d0\u793a",description:s})}throw e},l=(0,c.l7)({errorHandler:o,prefix:u.vU});l.use(function(){var e=(0,n.Z)(i().mark((function e(t,r){var n,a;return i().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:if(n=t.res,a=n.code,n.msg,200===a){e.next=6;break}return e.abrupt("return",Promise.reject({data:t,message:"CustomError"}));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),t["Z"]=l}}]);
//# sourceMappingURL=default.a7085d03.js.map